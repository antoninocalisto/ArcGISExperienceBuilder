System.register(["jimu-core","jimu-arcgis","esri/layers/FeatureLayer","esri/widgets/Legend","esri/renderers/ClassBreaksRenderer","esri/symbols/SimpleMarkerSymbol"],(function(e,t){var o={},r={},a={},i={},s={},n={};return{setters:[function(e){o.Global=e.Global,o.React=e.React,o.css=e.css,o.jsx=e.jsx},function(e){r.JimuMapViewComponent=e.JimuMapViewComponent},function(e){a.default=e.default},function(e){i.default=e.default},function(e){s.default=e.default},function(e){n.default=e.default}],execute:function(){e((()=>{var e={633:e=>{"use strict";e.exports=a},841:e=>{"use strict";e.exports=s},417:e=>{"use strict";e.exports=n},828:e=>{"use strict";e.exports=i},686:e=>{"use strict";e.exports=r},244:e=>{"use strict";e.exports=o}},t={};function l(o){var r=t[o];if(void 0!==r)return r.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,l),a.exports}l.d=(e,t)=>{for(var o in t)l.o(t,o)&&!l.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.p="";var c={};return l.p=window.jimuConfig.baseUrl,(()=>{"use strict";l.r(c),l.d(c,{__set_webpack_public_path__:()=>$,default:()=>O});var e=l(244),t=l(686),o=l(633),r=l(828),a=l(841),i=l(417),s=function(e,t,o,r){return new(o||(o=Promise))((function(a,i){function s(e){try{l(r.next(e))}catch(e){i(e)}}function n(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,n)}l((r=r.apply(e,t||[])).next())}))};const n={lateral:"rgba(88, 19, 252, 0.7)",testemunho:"rgba(255, 0, 255, 0.7)",calha:"rgba(245, 201, 38, 0.7)",plug:"rgba(125, 253, 148, 0.7)","whole core":"rgba(255, 43, 24, 0.7)"};var u=function(e,t,o,r){return new(o||(o=Promise))((function(a,i){function s(e){try{l(r.next(e))}catch(e){i(e)}}function n(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,n)}l((r=r.apply(e,t||[])).next())}))};const d={x:938,y:47,height:550},m=e=>Math.log10?Math.log10(e):Math.log(e)/Math.LN10,p={lateral:"totalAmostrasLaterais",testemunho:"totalTestemunhos",calha:"totalCalhas",plug:"totalPlugs","whole core":"totalWholeCore"},h=Object.keys(p),g=!1;function f(e){return new Promise(((t,o)=>{const r=Math.random().toString(36).slice(2);let a="*";try{document.referrer&&(a=new URL(document.referrer).origin)}catch(e){}const i=e=>{const a=e.data||{};var s;a.reqId===r&&("fetchDistribuicaoAmostras:ok"===a.type?(window.removeEventListener("message",i),t((s=a.payload,(Array.isArray(s)?s:[]).map((e=>{var t,o,r,a,i,s,n,l,c,u,d,m,p,h;return{codigoPoco:Number(null!==(a=null!==(r=null!==(o=null!==(t=e.codigoPoco)&&void 0!==t?t:e.POCO_CD_POCO)&&void 0!==o?o:e.poco)&&void 0!==r?r:e.codigo)&&void 0!==a?a:0),totalAmostrasLaterais:Number(null!==(s=null!==(i=e.totalAmostrasLaterais)&&void 0!==i?i:e.laterais)&&void 0!==s?s:0),totalCalhas:Number(null!==(l=null!==(n=e.totalCalhas)&&void 0!==n?n:e.calhas)&&void 0!==l?l:0),totalPlugs:Number(null!==(u=null!==(c=e.totalPlugs)&&void 0!==c?c:e.plugs)&&void 0!==u?u:0),totalTestemunhos:Number(null!==(m=null!==(d=e.totalTestemunhos)&&void 0!==d?d:e.testemunhos)&&void 0!==m?m:0),totalWholeCore:Number(null!==(h=null!==(p=e.totalWholeCore)&&void 0!==p?p:e.wholeCore)&&void 0!==h?h:0)}})).filter((e=>!!e.codigoPoco))))):"fetchDistribuicaoAmostras:err"===a.type&&(window.removeEventListener("message",i),o(new Error(a.message||"Erro no fetch via parent"))))};window.addEventListener("message",i),window.parent.postMessage({type:"fetchDistribuicaoAmostras",url:"/ExPlora/explora",body:e,reqId:r},a)}))}function b(){return u(this,arguments,void 0,(function*(e=!1){const t=function(e){const t=new URLSearchParams;return t.set("hdSys","novaintcons"),t.set("hdUC","Mapa"),t.set("hdAcao","CarregarMapaDistribuicaoAmostrasContador"),t.set("hdSessionFilter","true"),t.set("faixaInteresse",String(!!e)),t.toString()}(e);return f(t)}))}const v=e.css`
  /* largura base e z-index; nÃ£o quebrar drag/resize do EB */
  div[role='dialog'][aria-label='mapa-de-distribuicao-v2'],
  div[role='dialog'][aria-label='mapa-de-distribuicao']{
    z-index: 9999;
    width: ${360}px;
  }
`,y=e.css`
  width: ${40}px;
  height: ${40}px;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-right: 8px;
`,x=e.css`
  position: relative; width: 100%; height: 100%;
  background: #fff; border: 1px solid #ddd; border-radius: 6px;
  box-shadow: 0 4px 12px rgba(0,0,0,.1); padding: 16px; overflow: visible;
`,w=e.css`font-weight:600; margin-bottom:4px; display:block;`,C=e.css`width:100%; padding:6px 8px; margin-bottom:12px;
  border:1px solid #ccc; border-radius:4px;`,j=e.css`overflow-y:auto; margin-bottom:12px;
  padding:8px; background:#fafafa; border:1px solid #eee; border-radius:4px;`,M=e.css`display:flex; align-items:center; margin-bottom:6px; cursor:pointer;`,A=e.css`
  max-height: 300px;
  overflow-y: auto;
  margin-top: 8px;
  padding: 8px;
  padding-bottom: 36px;
  background: #fff;
  border: 1px solid #ddd;
  border-radius: 4px;
  position: relative;
`,R=e.css`display:flex; align-items:center; margin-bottom:6px;`,_=e.css`font-size:0.9rem;`,S=e.css`
  position: sticky;
  bottom: 0;
  background: #fff;
  border-top: 1px solid #eee;
  padding: 4px 0;
  display: flex;
  align-items: center;
`,E=e.css`
  display: flex;
  align-items: center;
  gap: 6px;
  cursor: pointer;
  font-size: 0.9rem;
`;function P(){const e=document.querySelector('div[role="dialog"][aria-label="mapa-de-distribuicao-v2"], div[role="dialog"][aria-label="mapa-de-distribuicao"]');if(!e)return{dlg:null,box:null,header:null};const t=e.querySelector('.jimu-dialog__header, .jimu-dialog-header, .dialog-header, [role="toolbar"], header')||null;let o=e.querySelector(".jimu-dialog__dialog, .jimu-dialog")||(null==t?void 0:t.parentElement)||null;return o&&t&&o===t&&(o=t.parentElement),o||(o=e),{dlg:e,box:o,header:t}}function k(e){return Array.from(e.querySelectorAll(".jimu-dialog__body, .jimu-dialog-body, .dialog-body, .modal-body, .jimu-dialog__content, .jimu-dialog-content"))}function L(e){if(!e)return!1;const t=(e.className||"").toString().toLowerCase(),o=(e.getAttribute("aria-label")||e.getAttribute("title")||e.textContent||"").toLowerCase();return/(^|\s)action-(collapse|expand)(\s|$)/.test(t)||/(recolher|minimizar|expandir|maximizar|restore|collapse|expand)/i.test(o)}function z(e){return e&&e.closest('button,[role="button"],[title],[aria-label],.icon,.icons,.jimu-title,[class*="action-"]')||null}function O(l){var c;const[f,O]=e.React.useState(),[$,F]=e.React.useState(""),[B,I]=e.React.useState([]),[N,q]=e.React.useState(!1),[D,V]=e.React.useState(null),[T,U]=e.React.useState(!1),[W,G]=e.React.useState(""),[J,H]=e.React.useState(!1),X=e.React.useRef(!1);e.React.useEffect((()=>{X.current=J}),[J]);const K=e.React.useRef([]),Q=e.React.useRef(null),Y=e.React.useRef(null);e.React.useEffect((()=>{let e=!1;return function(){u(this,void 0,void 0,(function*(){if("sample"===$){U(!0),G("");try{const t=yield b(g);e||(V(t),I([]),K.current=[])}catch(t){e||(G((null==t?void 0:t.message)||"Falha ao buscar dados"),V([]))}finally{e||U(!1)}}}))}(),()=>{e=!0}}),[$]);const Z=e.React.useCallback((e=>(null!=D?D:[]).map((t=>{var o;return{codigoPoco:t.codigoPoco,total:null!==(o=t[p[e]])&&void 0!==o?o:0}}))),[D]);e.React.useEffect((()=>{if(!f)return;if(!D||0===D.length)return;const{view:e}=f,t=new Set(K.current),l=new Set(B),c=[...l].filter((e=>!t.has(e)));[...t].filter((e=>!l.has(e))).forEach((t=>{const o=e.map.findLayerById("amostras_"+t);o&&e.map.remove(o)})),c.forEach((e=>{const t=Z(e),l=n[e]||"rgba(0,0,0,0.5)";!function(e){s(this,arguments,void 0,(function*({jimuMapView:e,dados:t,colorFill:s,idCamada:n,idLegenda:l,titleLegenda:c}){const u=e.view,d=u.map,m=`POCO_CD_POCO IN (${t.map((e=>e.codigoPoco)).join(",")})`,p=new o.default({url:"https://basegis.petrobras.com.br/arcgis/rest/services/EXPLORA/Feature_Pocos/MapServer/0",definitionExpression:m,title:"Po\xe7os",outFields:["*"],visible:!1});yield p.load();const h=(yield p.queryFeatures({where:m,outFields:["*"],returnGeometry:!0})).features.map((e=>{const o=t.find((t=>t.codigoPoco===e.attributes.POCO_CD_POCO));return e.attributes.POCO_MD_MERID_CENT=o?o.total:0,e})),g=t.map((e=>e.total));let f=Math.min(...g),b=Math.max(...g);const v=[],y={color:"black",width:"1px"};if(f===b&&0===f)v.push({minValue:0,maxValue:0,label:"N\xe3o h\xe1 dados suficientes",symbol:new i.default({color:"rgba(255,255,255,0)",size:0,style:"circle",outline:y})});else{const e=g.filter((e=>0===e)).length,t=g.filter((e=>e>0));e>0&&v.push({minValue:0,maxValue:0,label:`| 0 | (${e} po\xe7o${e>1?"s":""})`,symbol:new i.default({color:"rgba(200,200,200,0.3)",size:6,style:"circle",outline:y})}),f=1;const o=t.length,r=Math.max(2,Math.round(1+3.3*Math.log10(o))),a=Math.ceil((b-f+1)/r),n=40;for(let e=0;e<r;e++){const o=f+e*a,l=f+(e+1)*a-1;if(o>b)break;const c=t.filter((e=>e>=o&&e<=l)).length,u=`${o} |---| ${l} (${c} po\xe7o${c>1?"s":""})`,d=6+e*(n/r);v.push({minValue:o,maxValue:l,label:u,symbol:new i.default({color:s,size:d,style:"circle",outline:y})})}}const x=new a.default({field:"POCO_MD_MERID_CENT",classBreakInfos:v}),w=new o.default({id:n,source:h,fields:p.fields,objectIdField:"OBJECTID",geometryType:"point",spatialReference:{wkid:102100},renderer:x,title:c,listMode:"hide"}),C=d.findLayerById(n);C&&d.remove(C),d.add(w),new r.default({view:u,layerInfos:[{layer:w,title:c}]})}))}({jimuMapView:f,dados:t,colorFill:l,idCamada:"amostras_"+e,idLegenda:"lgd_amostras_"+e,titleLegenda:e.charAt(0).toUpperCase()+e.slice(1)})})),K.current=B}),[f,D,B,Z]);const ee=e.React.useCallback((()=>{var e,t;try{if(null==f?void 0:f.view){const{view:o}=f;h.forEach((e=>{const t=o.map.findLayerById("amostras_"+e);t&&o.map.remove(t)})),null===(t=null===(e=o.map.layers)||void 0===e?void 0:e.forEach)||void 0===t||t.call(e,(e=>{var t,r;(null===(r=null===(t=null==e?void 0:e.id)||void 0===t?void 0:t.startsWith)||void 0===r?void 0:r.call(t,"amostras_"))&&o.map.remove(e)}))}}catch(e){}I([]),K.current=[],q(!1),V(null),G(""),F(""),Y.current=null,H(!1);const{dlg:o}=P();o&&(o.removeAttribute("data-user-moved"),o.removeAttribute("data-user-sized")),Q.current&&(Q.current.style.display="block")}),[f]);e.React.useEffect((()=>{const{dlg:e,box:t}=P();if(!e||!t)return;const o=new MutationObserver((()=>{(e.style.transform||"").trim()&&!e.hasAttribute("data-user-moved")&&e.setAttribute("data-user-moved","1")}));o.observe(e,{attributes:!0,attributeFilter:["style"]});let r=Math.round(t.getBoundingClientRect().height);const a=new ResizeObserver((()=>{const o=Math.round(t.getBoundingClientRect().height);Math.abs(o-r)>=6&&(e.setAttribute("data-user-sized","1"),r=o)}));a.observe(t);const i=e.querySelector('button[aria-label="Close"], button[title="Close"], button[aria-label="Fechar"], button[title="Fechar"], [data-action="close"]');null==i||i.addEventListener("click",ee);let s=!1;const n=()=>{if(s)return;"true"===e.getAttribute("aria-hidden")||"none"===getComputedStyle(e).display||"hidden"===getComputedStyle(e).visibility||(e.hasAttribute("data-user-moved")||(e.style.transform=`translate(${d.x}px, ${d.y}px)`),e.hasAttribute("data-user-sized")||(t.style.height=`${d.height}px`,t.style.maxHeight="calc(100% - 24px)",t.style.overflow="visible"),k(e).forEach((e=>{e.style.removeProperty("display"),e.removeAttribute("aria-hidden")})),Q.current&&(Q.current.style.display="block"),H(!1),s=!0)},l=new MutationObserver(n);return l.observe(e,{attributes:!0,attributeFilter:["style","class","aria-hidden"]}),requestAnimationFrame(n),()=>{null==i||i.removeEventListener("click",ee),l.disconnect(),o.disconnect(),a.disconnect()}}),[ee]),e.React.useEffect((()=>{const{dlg:e,box:t}=P();if(!e||!t)return;const o=()=>e.querySelector('.jimu-dialog__header, .jimu-dialog-header, .dialog-header, [role="toolbar"], header')||e.firstElementChild,r=k(e),a=(o,r)=>{Array.from(new Set([e,t,...Array.from(e.querySelectorAll(".jimu-dialog__dialog, .jimu-dialog, .jimu-dialog__content, .jimu-dialog-content, .modal-content"))])).forEach((e=>{e.style.removeProperty("min-height"),e.style.setProperty("height",`${o}px`,"important"),e.style.setProperty("max-height",r?`${o}px`:"calc(100% - 24px)","important"),e.style.setProperty("overflow",r?"hidden":"visible","important")}))},i=t=>{const o=Math.max(120,Math.round(t||0))||d.height;a(o,!1),r.forEach((e=>{e.style.removeProperty("display"),e.removeAttribute("aria-hidden")})),Q.current&&(Q.current.style.display="block"),e.classList.remove("collapsed","minimized","is-collapsed","is-minimized"),e.removeAttribute("data-eb-collapsed"),e.setAttribute("aria-expanded","true")},s=s=>{if(s){const i=Math.round(t.getBoundingClientRect().height);i>100&&(Y.current=i);const s=o(),n=Math.max(40,Math.round((null==s?void 0:s.getBoundingClientRect().height)||56));a(n,!0),r.forEach((e=>{e.style.setProperty("display","none","important"),e.setAttribute("aria-hidden","true")})),Q.current&&(Q.current.style.display="none"),e.classList.add("collapsed"),e.setAttribute("data-eb-collapsed","1"),e.setAttribute("aria-expanded","false"),H(!0)}else{const e=Y.current&&Y.current>100?Y.current:d.height;i(e),H(!1),requestAnimationFrame((()=>i(e))),setTimeout((()=>i(e)),60),setTimeout((()=>i(e)),160)}},n=e=>{const o=z(e.target);if(!o||!L(o))return;const r=(o.className||"").toString().toLowerCase(),a=(o.getAttribute("aria-label")||o.getAttribute("title")||o.textContent||"").toLowerCase();if(r.includes("action-collapse")||/(recolher|minimizar|collapse)/i.test(a)){const e=Math.round(t.getBoundingClientRect().height);e>100&&(Y.current=e)}},l=e=>{const t=z(e.target);if(!t||!L(t))return;const o=(t.className||"").toString().toLowerCase(),r=(t.getAttribute("aria-label")||t.getAttribute("title")||t.textContent||"").toLowerCase();let a=null;(o.includes("action-collapse")||/(recolher|minimizar|collapse)/i.test(r))&&(a=!0),(o.includes("action-expand")||/(expandir|maximizar|restore|expand)/i.test(r))&&(a=!1),null===a&&(a=!X.current),s(a),requestAnimationFrame((()=>s(a)))},c=new ResizeObserver((()=>{if(!X.current){const e=o(),r=Math.max(40,Math.round((null==e?void 0:e.getBoundingClientRect().height)||56));if(Math.round(t.getBoundingClientRect().height)<=r+2){const e=Y.current&&Y.current>100?Y.current:d.height;i(e)}}}));return c.observe(t),document.addEventListener("pointerdown",n,!0),document.addEventListener("click",l,!0),()=>{c.disconnect(),document.removeEventListener("pointerdown",n,!0),document.removeEventListener("click",l,!0)}}),[]);const te=B.map((e=>{let t=function(e,t){const o=e.map((e=>e.total));let r=Math.min(...o),a=Math.max(...o);const i=[];if(0===r&&0===a)i.push({label:"N\xe3o h\xe1 dados suficientes",size:0,cor:t,count:0});else{const e=o.filter((e=>0===e)).length,s=o.filter((e=>e>0));e>0&&i.push({label:`| 0 | (${e} po\xe7o${e>1?"s":""})`,size:6,cor:"rgba(200,200,200,0.3)",count:e}),r=1;const n=s.length,l=Math.max(2,Math.round(1+3.3*m(n))),c=Math.ceil((a-r+1)/l),u=40;for(let e=0;e<l;e++){const o=r+e*c,n=r+(e+1)*c-1;if(o>a)break;const d=s.filter((e=>e>=o&&e<=n)).length,m=`${o} |---| ${n} (${d} po\xe7o${d>1?"s":""})`,p=6+e*(u/l);i.push({label:m,size:p,cor:t,count:d})}}return i}(Z(e),n[e]).reverse();return N||(t=t.filter((e=>e.count>0||e.label.startsWith("| 0 |")))),{tipo:e,rows:t}})),oe=Array.isArray(D)&&D.length>0;return(0,e.jsx)("div",{ref:Q,css:x},(0,e.jsx)(e.Global,{styles:v}),(0,e.jsx)("label",{css:w},"Selecione a distribui\xe7\xe3o"),(0,e.jsx)("select",{css:C,value:$,onChange:e=>{F(e.target.value)}},(0,e.jsx)("option",{value:""},"Selecione o tipo"),(0,e.jsx)("option",{value:"sample"},"Distribui\xe7\xe3o de amostra")),"sample"===$&&(0,e.jsx)(e.React.Fragment,null,T&&(0,e.jsx)("div",{style:{marginBottom:8}},"Carregando dados da sess\xe3o\u2026"),!!W&&(0,e.jsx)("div",{style:{color:"#b00",marginBottom:8}},"Erro: ",W),oe&&(0,e.jsx)("div",{css:j},h.map((t=>(0,e.jsx)("div",{key:t,css:M,onClick:()=>{return e=t,I((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]));var e}},(0,e.jsx)("input",{type:"checkbox",checked:B.includes(t),readOnly:!0,style:{marginRight:6}}),(0,e.jsx)("span",null,t.charAt(0).toUpperCase()+t.slice(1))))))),te.length>0&&(0,e.jsx)("div",{css:A},te.map((t=>(0,e.jsx)(e.React.Fragment,{key:t.tipo},(0,e.jsx)("div",{css:e.css`font-weight:600; margin:4px 0;`},t.tipo.charAt(0).toUpperCase()+t.tipo.slice(1)),t.rows.map(((o,r)=>(0,e.jsx)("div",{key:`${t.tipo}-${r}`,css:R},(0,e.jsx)("div",{css:y},(0,e.jsx)("svg",{width:o.size,height:o.size},(0,e.jsx)("circle",{cx:o.size/2,cy:o.size/2,r:o.size/2,fill:o.cor}))),(0,e.jsx)("span",{css:_},o.label))))))),(0,e.jsx)("div",{css:S},(0,e.jsx)("label",{css:E},(0,e.jsx)("input",{type:"checkbox",checked:N,onChange:e=>q(e.target.checked)}),"Exibir classes vazias"))),(0,e.jsx)(t.JimuMapViewComponent,{useMapWidgetId:null===(c=l.useMapWidgetIds)||void 0===c?void 0:c[0],onActiveViewChange:O}))}function $(e){l.p=e}})(),c})())}}}));