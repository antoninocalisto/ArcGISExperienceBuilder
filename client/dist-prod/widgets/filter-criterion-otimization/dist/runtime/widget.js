System.register(["jimu-core/react","jimu-arcgis","esri/config","esri/layers/FeatureLayer","esri/geometry/Extent","esri/layers/GroupLayer"],(function(e,t){var o={},r={},n={},i={},s={},a={};return{setters:[function(e){o.default=e.default,o.useEffect=e.useEffect,o.useRef=e.useRef,o.useState=e.useState},function(e){r.JimuMapViewComponent=e.JimuMapViewComponent},function(e){n.default=e.default},function(e){i.default=e.default},function(e){s.default=e.default},function(e){a.default=e.default}],execute:function(){e((()=>{var e={725:e=>{"use strict";e.exports=n},420:e=>{"use strict";e.exports=s},633:e=>{"use strict";e.exports=i},750:e=>{"use strict";e.exports=a},686:e=>{"use strict";e.exports=r},972:e=>{"use strict";e.exports=o}},t={};function u(o){var r=t[o];if(void 0!==r)return r.exports;var n=t[o]={exports:{}};return e[o](n,n.exports,u),n.exports}u.d=(e,t)=>{for(var o in t)u.o(t,o)&&!u.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},u.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),u.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.p="";var c={};return u.p=window.jimuConfig.baseUrl,(()=>{"use strict";u.r(c),u.d(c,{__set_webpack_public_path__:()=>g,default:()=>p});var e=u(972),t=u(686),o=u(725),r=u(633),n=u(420),i=u(750),s=function(e,t,o,r){return new(o||(o=Promise))((function(n,i){function s(e){try{u(r.next(e))}catch(e){i(e)}}function a(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))};o.default.request.interceptors.push({urls:/Pocos_Sem_Simbolos\/FeatureServer\/0/,before:e=>{e.requestOptions.query=Object.assign(Object.assign({},e.requestOptions.query),{f:"json"})}});const a="https://basegis.petrobras.com.br/arcgis/rest/services/EXPLORA/Pocos_Sem_Simbolos/FeatureServer/0",l=600,d=40,f=new n.default({xmin:-74,ymin:-34,xmax:-34,ymax:5,spatialReference:{wkid:4326}});function p(o){var n;const u=(0,e.useRef)(),[c,p]=(0,e.useState)(null),[g,m]=(0,e.useState)([]),y=["https://localhost:3001","https://portalgis.petrobras.com.br","http://localhost:8080"];return(0,e.useEffect)((()=>{const e=e=>{if(!y.includes(e.origin))return void console.warn("Origem n\xe3o permitida:",e.origin);const{type:t,data:o}=e.data||{};"codigosPocos"===t&&Array.isArray(o)&&o.length>0&&m(o)};return window.addEventListener("message",e),()=>window.removeEventListener("message",e)}),[]),(0,e.useEffect)((()=>{c&&window.parent.postMessage({type:"widgetReady"},"*")}),[c]),(0,e.useEffect)((()=>{c&&g.length>0&&function(e,t){s(this,void 0,void 0,(function*(){try{e.view&&(e.view.extent=f)}catch(e){}const o=e.view.map;let n=o.layers.find((e=>"pocos-group"===e.id));n||(n=new i.default({id:"pocos-group",title:"Po\xe7os",visibilityMode:"inherited",listMode:"show"}),o.add(n));const s=[];n.layers.forEach((e=>{var t;(null===(t=e.id)||void 0===t?void 0:t.startsWith("pocos-lote-"))&&s.push(e)})),s.forEach((e=>n.remove(e)));const u=new r.default({url:a});yield u.load();const c=u.fields.find((e=>"POCO_CD_POCO"===e.name)),p="string"===(null==c?void 0:c.type),g=Math.ceil(t.length/l);g>d&&console.warn(`Quantidade de camadas estimada (${g}) excede o limite (${d}). Aumente CHUNK_SIZE, reduza a lista ou considere backend.`);let m=0;const y=t.length;console.log(`\u25b6\ufe0f Iniciando plotagem: ${y} c\xf3digos em at\xe9 ${Math.min(g,d)} lotes.`);for(let e=0;e<t.length&&e/l<d;e+=l){const o=Math.floor(e/l)+1,i=t.slice(e,e+l),s=`POCO_CD_POCO IN (${p?i.map((e=>`'${String(e).trim()}'`)).join(","):i.join(",")})`;console.log(`\u{1f9e9} Preparando lote ${o}: ${i.length} c\xf3digos`);const u=new r.default({id:`pocos-lote-${String(o).padStart(3,"0")}`,url:a,title:`Po\xe7os (lote ${o})`,definitionExpression:s,outFields:["POCO_CD_POCO"],featureReduction:null,listMode:"hide"});try{yield u.load(),n.add(u);const e=yield u.queryFeatureCount({where:s});m+=e,console.log(`\u2705 Lote ${o}: +${e} (acumulado ${m}/${y})`)}catch(e){console.error("Erro ao carregar/contar lote",o,e)}}console.log(`\u{1f3c1} Plotagem conclu\xedda. Total retornado: ${m}/${y}`)}))}(c,g)}),[c,g]),e.default.createElement("div",{style:{height:"100%",width:"100%"}},e.default.createElement(t.JimuMapViewComponent,{useMapWidgetId:null===(n=o.useMapWidgetIds)||void 0===n?void 0:n[0],onActiveViewChange:e=>{e&&(u.current=e,p(e))}}))}function g(e){u.p=e}})(),c})())}}}));