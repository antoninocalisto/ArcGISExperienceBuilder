System.register(["jimu-core","jimu-arcgis","esri/layers/FeatureLayer","esri/widgets/Legend","esri/renderers/ClassBreaksRenderer","esri/symbols/SimpleMarkerSymbol"],(function(e,t){var o={},a={},s={},l={},i={},r={};return{setters:[function(e){o.Global=e.Global,o.React=e.React,o.css=e.css,o.jsx=e.jsx},function(e){a.JimuMapViewComponent=e.JimuMapViewComponent},function(e){s.default=e.default},function(e){l.default=e.default},function(e){i.default=e.default},function(e){r.default=e.default}],execute:function(){e((()=>{var e={633:e=>{"use strict";e.exports=s},841:e=>{"use strict";e.exports=i},417:e=>{"use strict";e.exports=r},828:e=>{"use strict";e.exports=l},686:e=>{"use strict";e.exports=a},244:e=>{"use strict";e.exports=o}},t={};function n(o){var a=t[o];if(void 0!==a)return a.exports;var s=t[o]={exports:{}};return e[o](s,s.exports,n),s.exports}n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="";var c={};return n.p=window.jimuConfig.baseUrl,(()=>{"use strict";n.r(c),n.d(c,{__set_webpack_public_path__:()=>L,default:()=>k});var e=n(244),t=n(686),o=n(633),a=n(828),s=n(841),l=n(417),i=function(e,t,o,a){return new(o||(o=Promise))((function(s,l){function i(e){try{n(a.next(e))}catch(e){l(e)}}function r(e){try{n(a.throw(e))}catch(e){l(e)}}function n(e){var t;e.done?s(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,r)}n((a=a.apply(e,t||[])).next())}))};const r={lateral:"rgba(88, 19, 252, 0.7)",testemunho:"rgba(255, 0, 255, 0.7)",calha:"rgba(245, 201, 38, 0.7)",plug:"rgba(125, 253, 148, 0.7)","whole core":"rgba(255, 43, 24, 0.7)"};const d=e=>Math.log10?Math.log10(e):Math.log(e)/Math.LN10;const u=e.css`
  div[role='dialog'][aria-label='mapa de distribuição'] {
    height: 550px !important;
    max-height: 550px !important;
  }
`,p=e.css`
  width: ${40}px;
  height: ${40}px;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-right: 8px;
`,h=e.css`
  position: relative; width: 100%; height: 100%;
  background: #fff; border: 1px solid #ddd; border-radius: 6px;
  box-shadow: 0 4px 12px rgba(0,0,0,.1); padding: 16px; overflow: hidden;
`,g=e.css`font-weight:600; margin-bottom:4px; display:block;`,m=e.css`width:100%; padding:6px 8px; margin-bottom:12px;
  border:1px solid #ccc; border-radius:4px;`,f=e.css`overflow-y:auto; margin-bottom:12px;
  padding:8px; background:#fafafa; border:1px solid #eee; border-radius:4px;`,x=e.css`display:flex; align-items:center; margin-bottom:6px; cursor:pointer;`,b=e.css`
  max-height: 300px;
  overflow-y: auto;
  margin-top: 8px;
  padding: 8px;
  padding-bottom: 36px;
  background: #fff;
  border: 1px solid #ddd;
  border-radius: 4px;
  position: relative;
`,y=e.css`display:flex; align-items:center; margin-bottom:6px;`,v=e.css`font-size:0.9rem;`,C=e.css`
  position: sticky;
  bottom: 0;
  background: #fff;
  border-top: 1px solid #eee;
  padding: 4px 0;
  display: flex;
  align-items: center;
  gap: 16px; /* espaço entre os controles do rodapé */
`,w=e.css`
  display: flex;
  align-items: center;
  gap: 6px;
  cursor: pointer;
  font-size: 0.9rem;
`,P={lateral:"totalAmostrasLaterais",testemunho:"totalTestemunhos",calha:"totalCalhas",plug:"totalPlugs","whole core":"totalWholeCore"},j=Object.keys(P),M=[{codigoPoco:1010,totalAmostrasLaterais:0,totalCalhas:3,totalPlugs:0,totalTestemunhos:14,totalWholeCore:0},{codigoPoco:1340,totalAmostrasLaterais:0,totalCalhas:269,totalPlugs:0,totalTestemunhos:33,totalWholeCore:0},{codigoPoco:1592,totalAmostrasLaterais:0,totalCalhas:19,totalPlugs:0,totalTestemunhos:20,totalWholeCore:0},{codigoPoco:2014,totalAmostrasLaterais:0,totalCalhas:0,totalPlugs:0,totalTestemunhos:15,totalWholeCore:0},{codigoPoco:4230,totalAmostrasLaterais:24,totalCalhas:0,totalPlugs:0,totalTestemunhos:7,totalWholeCore:0},{codigoPoco:4327,totalAmostrasLaterais:12,totalCalhas:26,totalPlugs:0,totalTestemunhos:16,totalWholeCore:0},{codigoPoco:4437,totalAmostrasLaterais:0,totalCalhas:0,totalPlugs:0,totalTestemunhos:5,totalWholeCore:0},{codigoPoco:4523,totalAmostrasLaterais:0,totalCalhas:0,totalPlugs:0,totalTestemunhos:2,totalWholeCore:0},{codigoPoco:7944,totalAmostrasLaterais:0,totalCalhas:228,totalPlugs:0,totalTestemunhos:3,totalWholeCore:0},{codigoPoco:8830,totalAmostrasLaterais:0,totalCalhas:40,totalPlugs:51,totalTestemunhos:3,totalWholeCore:0},{codigoPoco:17696,totalAmostrasLaterais:44,totalCalhas:17,totalPlugs:0,totalTestemunhos:1,totalWholeCore:0}];function k(n){var c;const[k,L]=e.React.useState(),[_,A]=e.React.useState(""),[O,I]=e.React.useState([]),[R,S]=e.React.useState(!1),[T,$]=e.React.useState(!1),[z,W]=e.React.useState((()=>new Set(Array.isArray(null==n?void 0:n.codigosFaixaInteresse)?n.codigosFaixaInteresse:[])));e.React.useEffect((()=>{const e=e=>{const t=null==e?void 0:e.data;t&&"faixa-interesse"===t.type&&Array.isArray(t.codigosPocos)&&W(new Set(t.codigosPocos))};return window.addEventListener("message",e),()=>window.removeEventListener("message",e)}),[]);const E=e.React.useCallback((e=>T&&z&&0!==z.size?e.filter((e=>z.has(e.codigoPoco))):e),[T,z]),V=e.React.useCallback((e=>E(M.map((t=>({codigoPoco:t.codigoPoco,total:t[P[e]]}))))),[E]);e.React.useEffect((()=>{if(!k)return;const{view:e}=k;j.forEach((t=>{const o=e.map.findLayerById("amostras_"+t);o&&e.map.remove(o)})),O.forEach((e=>{const t=V(e),n=r[e]||"rgba(0,0,0,0.5)";!function(e){i(this,arguments,void 0,(function*({jimuMapView:e,dados:t,colorFill:i,idCamada:r,idLegenda:n,titleLegenda:c}){const d=e.view,u=d.map,p=`POCO_CD_POCO IN (${t.map((e=>e.codigoPoco)).join(",")})`,h=new o.default({url:"https://basegis.petrobras.com.br/arcgis/rest/services/EXPLORA/Feature_Pocos/MapServer/0",definitionExpression:p,title:"Po\xe7os",outFields:["*"],visible:!1});yield h.load();const g=(yield h.queryFeatures({where:p,outFields:["*"],returnGeometry:!0})).features.map((e=>{const o=t.find((t=>t.codigoPoco===e.attributes.POCO_CD_POCO));return e.attributes.POCO_MD_MERID_CENT=o?o.total:0,e})),m=t.map((e=>e.total));let f=Math.min(...m),x=Math.max(...m);const b=[],y={color:"black",width:"1px"};if(f===x&&0===f)b.push({minValue:0,maxValue:0,label:"N\xe3o h\xe1 dados suficientes",symbol:new l.default({color:"rgba(255,255,255,0)",size:0,style:"circle",outline:y})});else{const e=m.filter((e=>0===e)).length,t=m.filter((e=>e>0));e>0&&b.push({minValue:0,maxValue:0,label:`| 0 | (${e} po\xe7o${e>1?"s":""})`,symbol:new l.default({color:"rgba(200,200,200,0.3)",size:6,style:"circle",outline:y})}),f=1;const o=t.length,a=Math.max(2,Math.round(1+3.3*Math.log10(o))),s=Math.ceil((x-f+1)/a),r=40;for(let e=0;e<a;e++){const o=f+e*s,n=f+(e+1)*s-1;if(o>x)break;const c=t.filter((e=>e>=o&&e<=n)).length,d=`${o} |---| ${n} (${c} po\xe7o${c>1?"s":""})`,u=6+e*(r/a);b.push({minValue:o,maxValue:n,label:d,symbol:new l.default({color:i,size:u,style:"circle",outline:y})})}}const v=new s.default({field:"POCO_MD_MERID_CENT",classBreakInfos:b}),C=new o.default({id:r,source:g,fields:h.fields,objectIdField:"OBJECTID",geometryType:"point",spatialReference:{wkid:102100},renderer:v,title:c,listMode:"hide"}),w=u.findLayerById(r);w&&u.remove(w),u.add(C),new a.default({view:d,layerInfos:[{layer:C,title:c}]})}))}({jimuMapView:k,dados:t,colorFill:n,idCamada:"amostras_"+e,idLegenda:"lgd_amostras_"+e,titleLegenda:(T?"Intervalo de Interesse - ":"")+(e.charAt(0).toUpperCase()+e.slice(1)),withInterest:T})}))}),[k,O,V,T]);const F=O.map((e=>{let t=function(e,t){const o=e.map((e=>e.total));let a=Math.min(...o),s=Math.max(...o);const l=[];if(0===a&&0===s)l.push({label:"N\xe3o h\xe1 dados suficientes",size:0,cor:t,count:0});else{const e=o.filter((e=>0===e)).length,i=o.filter((e=>e>0));e>0&&l.push({label:`| 0 | (${e} po\xe7o${e>1?"s":""})`,size:6,cor:"rgba(200,200,200,0.3)",count:e}),a=1;const r=i.length,n=Math.max(2,Math.round(1+3.3*d(r))),c=Math.ceil((s-a+1)/n),u=40;for(let e=0;e<n;e++){const o=a+e*c,r=a+(e+1)*c-1;if(o>s)break;const d=i.filter((e=>e>=o&&e<=r)).length,p=`${o} |---| ${r} (${d} po\xe7o${d>1?"s":""})`,h=6+e*(u/n);l.push({label:p,size:h,cor:t,count:d})}}return l}(V(e),r[e]).reverse();return R||(t=t.filter((e=>e.count>0||e.label.startsWith("| 0 |")))),{tipo:e,rows:t}}));return(0,e.jsx)("div",{css:h},(0,e.jsx)(e.Global,{styles:u}),(0,e.jsx)("label",{css:g},"Selecione a distribui\xe7\xe3o"),(0,e.jsx)("select",{css:m,value:_,onChange:e=>{A(e.target.value),I([])}},(0,e.jsx)("option",{value:""},"Selecione o tipo"),(0,e.jsx)("option",{value:"sample"},"Distribui\xe7\xe3o de amostra")),"sample"===_&&(0,e.jsx)("div",{css:f},j.map((t=>(0,e.jsx)("div",{key:t,css:x,onClick:()=>{return e=t,I((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]));var e}},(0,e.jsx)("input",{type:"checkbox",checked:O.includes(t),readOnly:!0,style:{marginRight:6}}),(0,e.jsx)("span",null,t.charAt(0).toUpperCase()+t.slice(1)))))),F.length>0&&(0,e.jsx)("div",{css:b},F.map((t=>(0,e.jsx)(e.React.Fragment,{key:t.tipo},(0,e.jsx)("div",{css:e.css`font-weight:600; margin:4px 0;`},T?"Intervalo de Interesse - ":"",t.tipo.charAt(0).toUpperCase()+t.tipo.slice(1)),t.rows.map(((o,a)=>(0,e.jsx)("div",{key:`${t.tipo}-${a}`,css:y},(0,e.jsx)("div",{css:p},(0,e.jsx)("svg",{width:o.size,height:o.size},(0,e.jsx)("circle",{cx:o.size/2,cy:o.size/2,r:o.size/2,fill:o.cor}))),(0,e.jsx)("span",{css:v},o.label))))))),(0,e.jsx)("div",{css:C},(0,e.jsx)("label",{css:w},(0,e.jsx)("input",{type:"checkbox",checked:R,onChange:e=>S(e.target.checked)}),"Exibir classes vazias"),(0,e.jsx)("label",{css:w,title:"Quando marcado, filtra apenas os po\xe7os do intervalo de interesse"},(0,e.jsx)("input",{type:"checkbox",checked:T,onChange:e=>$(e.target.checked)}),"Intervalo de interesse"))),(0,e.jsx)(t.JimuMapViewComponent,{useMapWidgetId:null===(c=n.useMapWidgetIds)||void 0===c?void 0:c[0],onActiveViewChange:L}))}function L(e){n.p=e}})(),c})())}}}));